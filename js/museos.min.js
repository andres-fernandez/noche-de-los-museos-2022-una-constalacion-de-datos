var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.createTemplateTagFirstArg=function(a){return a.raw=a};$jscomp.createTemplateTagFirstArgWithRaw=function(a,b){a.raw=b;return a};
var start=performance.now(),hideTooltip=function(){return d3.select(".tooltip").style("opacity",0)},showTooltip=function(a){var b=d3.select(this),c=d3.select(this.parentNode).attr("data-museum"),d=b.attr("data-key");b=b.attr("data-value");var e="area"==d?"m<sup>2</sup>":"";b="foundation"==d?b:b.replace(/\d(?=(?:\d{3})+(?!\d))/g,"$&.");d3.select(".tooltip").style("opacity","1").style("left",a.pageX-20+"px").style("top",a.pageY-70+"px").html('<span class="tooltip-headline">'+c.split("-")[0].trim()+
'</span><br><span class="tooltip-data">'+{foundation:"A\u00f1o de fundaci\u00f3n: ",objects:"Cantidad de objetos: ",colections:"N\u00famero de colecciones: ",area:"Superficie: "}[d]+" <strong>"+b+"</strong>"+e+"</span>")},showTooltipMuseumName=function(a){var b=d3.select(this).attr("data-svg-icon-mask");d3.select(".tooltip").style("opacity","1").style("left",a.pageX-20+"px").style("top",a.pageY-50+"px").html('<span class="tooltip-headline">'+b.split("-")[0].trim()+"</span>")},dataset_museos=JSON.parse(JSON.stringify(dataset_museos_verificado));
dataset_museos=d3.sort(dataset_museos,function(a){return a.nodo});
for(var colorramp="#f0d675 #f8bc53 #f9a237 #f58a22 #eb7311 #dc6006 #c84f02 #b24301 #771b0c".split(" "),colorramp_nodes=["#11a4ad","#ffcf5e","#068b78","#9ed79a","#f2ff97"],width=500,height=500,margin=200,max_radio=width/1.95,center_x=(width+2*margin)/2,center_y=(height+2*margin)/2,radius_for_dataset_c=.58*width,how_many_museos=dataset_museos.length,museos_properties=["foundation","objects","colections","area"],how_many_property_by_museo=museos_properties.length+1,angle_by_museo=+(360/how_many_museos).toFixed(4),
angle_by_museo_property=+(360/(how_many_museos*how_many_property_by_museo)).toFixed(4),dataset_museos_angles=d3.range(0,360,angle_by_museo_property),array_from_museos_properties_values_v2={},$jscomp$loop$m675467045$0={i$jscomp$3:0};$jscomp$loop$m675467045$0.i$jscomp$3<museos_properties.length;$jscomp$loop$m675467045$0={i$jscomp$3:$jscomp$loop$m675467045$0.i$jscomp$3},$jscomp$loop$m675467045$0.i$jscomp$3++)array_from_museos_properties_values_v2[museos_properties[$jscomp$loop$m675467045$0.i$jscomp$3]]=
dataset_museos.map(function(a){return function(b,c){return[angle_by_museo*c+angle_by_museo_property*(a.i$jscomp$3+1),b[museos_properties[a.i$jscomp$3]]]}}($jscomp$loop$m675467045$0));
var svg=d3.select("#dataviz-museos").append("svg").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("viewBox",[0,0,width+2*margin,height+2*margin]).attr("id","noche-de-los-museos-2022").attr("title","Dataviz sobre los museos de la Universidad Nacional de C\u00f3rdoba").attr("desc",function(){return"Visualizaci\u00f3n realizada para la Noche de los Museos 2022 | Colorramp: "+colorramp.join(", ")}),canvas=svg.append("g").attr("id","dataviz-canvas").append("rect").attr("width",
width+2*margin).attr("height",height+2*margin).attr("fill","#031f30"),reference=svg.append("g").attr("id","dataviz-reference"),radial_container=reference.append("g").attr("id","radial-lines-reference").attr("transform","translate("+[center_x,center_y]+")"),dataset_c=d3.range(0,2+2/dataset_museos.length,2/dataset_museos.length).map(function(a){return[Math.PI*a]}),draw_dataset_c=radial_container.append("path").attr("id","radial-line-dataset-c").attr("d",d3.lineRadial().radius(function(a){return.58*
width})(dataset_c)).attr("fill","none").attr("stroke-width",1.5).attr("stroke","#9ed79a"),center_point=reference.append("circle").attr("id","center-white-circle").attr("cx",center_x).attr("cy",center_y).attr("r",1).attr("fill","#fff"),dataviz_grid=svg.append("g").attr("id","dataviz-grid").attr("transform","translate("+[center_x,center_y]+")"),lineRadial_grid_angle_property=d3.lineRadial().angle(function(a){return a*Math.PI/180}).radius(function(a){return.64*width}),grid_angle_property=dataviz_grid.append("g").attr("id",
"dataviz-grid-property").attr("stroke","#fff").attr("stroke-width",.15).selectAll("line").data(d3.range(0,360,angle_by_museo_property)).join("line").attr("x1",0).attr("y1",0).attr("x2",function(a){return lineRadial_grid_angle_property([a]).split(",")[0].slice(1)}).attr("y2",function(a){return lineRadial_grid_angle_property([a]).split(",")[1].slice(0,-1)}),lineRadial_grid_angle_museos=d3.lineRadial().angle(function(a){return a*Math.PI/180}).radius(function(a){return.67*width}),grid_angle_museos=dataviz_grid.append("g").attr("id",
"dataviz-grid-museos").attr("stroke","#fff").attr("stroke-width",.3).selectAll("line").data(d3.range(0,360,angle_by_museo)).join("line").attr("x1",0).attr("y1",0).attr("x2",function(a){return lineRadial_grid_angle_museos([a]).split(",")[0].slice(1)}).attr("y2",function(a){return lineRadial_grid_angle_museos([a]).split(",")[1].slice(0,-1)}),grid_mask_circle=dataviz_grid.append("circle").attr("cx",0).attr("cy",0).attr("r",radius_for_dataset_c-.5).attr("fill","#031f30").attr("fill-opacity",.7),dataviz_render=
svg.append("g").attr("id","dataviz-render").attr("transform","translate("+[center_x,center_y]+")"),foundation_line_scale=d3.scaleLinear().domain(d3.extent(dataset_museos,function(a){return a.foundation})).range([1,max_radio]),objects_line_scale=d3.scaleLog().domain(d3.extent(dataset_museos,function(a){return a.objects})).range([1,max_radio]),colections_line_scale=d3.scaleLog().domain(d3.extent(dataset_museos,function(a){return a.colections})).range([1,max_radio]),area_line_scale=d3.scaleLog().domain(d3.extent(dataset_museos,
function(a){return a.area})).range([1,max_radio]);foundation_line_scale=d3.scaleLinear().domain([1860,2022]).range([0,max_radio]);objects_line_scale=d3.scaleLog().domain([1,515E3]).range([0,max_radio]);colections_line_scale=d3.scaleLog().domain([1,200]).range([0,max_radio]);area_line_scale=d3.scaleLog().domain([1,8100]).range([0,max_radio]);
var foundation_radius_scale=d3.scaleSqrt().domain(d3.extent(dataset_museos,function(a){return a.foundation})).range([15,5]),objects_radius_scale=d3.scaleSqrt().domain(d3.extent(dataset_museos,function(a){return a.objects})).range([8,35]),colections_radius_scale=d3.scaleSqrt().domain(d3.extent(dataset_museos,function(a){return a.colections})).range([5,30]),area_radius_scale=d3.scaleSqrt().domain(d3.extent(dataset_museos,function(a){return a.area})).range([5,30]),foundation_line_radial=d3.lineRadial().angle(function(a){return a[0]*
Math.PI/180}).radius(function(a){return foundation_line_scale(a[1])}).defined(function(a){return null!==a[1]}).curve(d3.curveStepAfter),objects_line_radial=d3.lineRadial().angle(function(a){return a[0]*Math.PI/180}).radius(function(a){return objects_line_scale(a[1])}).defined(function(a){return null!==a[1]}).curve(d3.curveStepAfter),colections_line_radial=d3.lineRadial().angle(function(a){return a[0]*Math.PI/180}).radius(function(a){return colections_line_scale(a[1])}).defined(function(a){return null!==
a[1]}).curve(d3.curveStepAfter),area_line_radial=d3.lineRadial().angle(function(a){return a[0]*Math.PI/180}).radius(function(a){return area_line_scale(a[1])}).defined(function(a){return null!==a[1]}).curve(d3.curveStepAfter),coords=Object.entries(array_from_museos_properties_values_v2),museoGridLines=dataviz_render.append("g").attr("id","dataviz-render-lines").selectAll("g").data(coords).join("g").attr("id",function(a){return a[0]+"-line"}).append("path").attr("fill","none").attr("stroke",function(a,
b){return colorramp_nodes[b]}).attr("stroke-width",function(a){return 1}).attr("stroke-dasharray",function(a){return"1,2.5"}).attr("stroke-linecap","round").attr("d",function(a){if("foundation"==a[0])return foundation_line_radial(a[1]);if("objects"==a[0])return objects_line_radial(a[1]);if("colections"==a[0])return colections_line_radial(a[1]);if("area"==a[0])return area_line_radial(a[1])}),museosStars=dataviz_render.append("g").attr("id","dataviz-render-dots").selectAll("g").data(dataset_museos).join("g").attr("data-museum",
function(a){return a.museum}),foundation_stars=museosStars.append("circle").attr("data-key","foundation").attr("data-value",function(a){return a.foundation}).attr("transform",function(a,b){if(a.foundation)return"translate("+foundation_line_radial([[b*angle_by_museo+angle_by_museo_property,a.foundation]]).slice(1).slice(0,-1)+")"}).attr("r",function(a){return foundation_radius_scale(a.foundation)}).attr("fill",function(a){return colorramp[Math.trunc(Math.random()*colorramp.length)]}).on("mouseover",
showTooltip).on("mouseout",hideTooltip),objects_stars=museosStars.append("circle").attr("data-key","objects").attr("data-value",function(a){return a.objects}).attr("transform",function(a,b){if(a.objects)return"translate("+objects_line_radial([[b*angle_by_museo+2*angle_by_museo_property,a.objects]]).slice(1).slice(0,-1)+")"}).attr("r",function(a){return objects_radius_scale(a.objects)}).attr("fill",function(a){return colorramp[Math.trunc(Math.random()*colorramp.length)]}).on("mouseover",showTooltip).on("mouseout",
hideTooltip),colections_stars=museosStars.append("circle").attr("data-key","colections").attr("data-value",function(a){return a.colections}).attr("transform",function(a,b){if(a.colections)return"translate("+colections_line_radial([[b*angle_by_museo+3*angle_by_museo_property,a.colections]]).slice(1).slice(0,-1)+")"}).attr("r",function(a){return colections_radius_scale(a.colections)}).attr("fill",function(a){return colorramp[Math.trunc(Math.random()*colorramp.length)]}).on("mouseover",showTooltip).on("mouseout",
hideTooltip),area_stars=museosStars.append("circle").attr("data-key","area").attr("data-value",function(a){return a.area}).attr("transform",function(a,b){if(a.area)return"translate("+area_line_radial([[b*angle_by_museo+4*angle_by_museo_property,a.area]]).slice(1).slice(0,-1)+")"}).attr("r",function(a){return area_radius_scale(a.area)}).attr("fill",function(a){return colorramp[Math.trunc(Math.random()*colorramp.length)]}).on("mouseover",showTooltip).on("mouseout",hideTooltip);d3.selectAll("#dataviz-render-dots circle:not([transform])").remove();
for(var nodes=svg.append("g").attr("id","dataviz-nodes").attr("transform","translate("+[center_x,center_y]+")"),group_museo_by_node=d3.flatGroup(dataset_museos,function(a){return a.nodo}),temp_museos_by_node=group_museo_by_node.map(function(a){return a[1].length}),museos_by_nodo=[],accumulator=0,i$jscomp$9=0;i$jscomp$9<temp_museos_by_node.length;i$jscomp$9++)accumulator+=temp_museos_by_node[i$jscomp$9],museos_by_nodo.push(accumulator);
var nodes_arc_generator=d3.arc().innerRadius(.605*width).outerRadius(.62*width).padAngle(.07).padRadius(100),nodes_render_arcs=nodes.selectAll("path").data(museos_by_nodo).join("path").attr("d",function(a,b){return nodes_arc_generator({startAngle:(0==b?0:museos_by_nodo[b-1]*angle_by_museo)*Math.PI/180,endAngle:(b==museos_by_nodo.length?360:museos_by_nodo[b]*angle_by_museo)*Math.PI/180})}).attr("fill",function(a,b){return colorramp_nodes[b]}),middle_angle_by_museo=d3.range(0,359,angle_by_museo).map(function(a){return a+
2.5*angle_by_museo_property}),lineRadial_coords_middle_museos=d3.lineRadial().angle(function(a){return a*Math.PI/180}).radius(function(a){return.8*width}),lineRadial_coords_middle_museos_grid=d3.lineRadial().angle(function(a){return a*Math.PI/180}).radius(function(a){return.73*width}),dataviz_icons=svg.append("g").attr("id","dataviz-icons").attr("transform","translate("+[center_x,center_y]+")"),museo_icon_size=110,dataviz_museos_icons_img=dataviz_icons.append("g").attr("id","dataviz-icons-img").selectAll("svg").data(middle_angle_by_museo).join("svg").attr("xml:space",
"preserve").attr("width",museo_icon_size).attr("height",museo_icon_size).attr("data-svg-icon",function(a,b){return dataset_museos[b].museum}).attr("x",function(a){return(lineRadial_coords_middle_museos([a]).split(",")[0].slice(1)-museo_icon_size/2).toFixed(3)}).attr("y",function(a){return(lineRadial_coords_middle_museos([a]).split(",")[1].slice(0,-1)-museo_icon_size/2).toFixed(3)}).append("use").attr("xlink:href",function(a,b){return dataset_museos[b].icon}),museo_icon_mask_size=106,dataviz_icons_mask=
dataviz_icons.append("g").attr("id","dataviz-icons-mask").attr("transform","translate("+[museo_icon_mask_size/2,museo_icon_mask_size/2]+")").attr("fill","#031f30").attr("fill-opacity","0.0001");
dataviz_icons_mask.selectAll("circle").data(middle_angle_by_museo).join("circle").attr("r",museo_icon_mask_size/2).attr("data-svg-icon-mask",function(a,b){return dataset_museos[b].museum}).attr("cx",function(a){return(lineRadial_coords_middle_museos([a]).split(",")[0].slice(1)-museo_icon_size/2).toFixed(3)}).attr("cy",function(a){return(lineRadial_coords_middle_museos([a]).split(",")[1].slice(0,-1)-museo_icon_size/2).toFixed(3)}).on("mouseover",showTooltipMuseumName).on("mouseout",hideTooltip);
var foundation_axes=d3.axisBottom(foundation_line_scale).ticks(3),objects_axes=d3.axisBottom(objects_line_scale).ticks(5),colections_axes=d3.axisBottom(colections_line_scale).ticks(5),area_axes=d3.axisBottom(area_line_scale).ticks(3),axes_container=svg.append("g").attr("id","dataviz-axes").attr("style","color:#0ff; display:none").attr("transform","translate("+[center_x,150]+")"),axes_container_property=axes_container.selectAll("g").data(museos_properties).join("g").attr("data-scale",function(a){return a}).attr("transform",
function(a,b){return"translate("+[0,150*b]+")"}),foundation_axes_container=d3.select('#dataviz-axes g[data-scale="foundation"]'),objects_axes_container=d3.select('#dataviz-axes g[data-scale="objects"]'),colections_axes_container=d3.select('#dataviz-axes g[data-scale="colections"]'),area_axes_container=d3.select('#dataviz-axes g[data-scale="area"]');foundation_axes_container.call(foundation_axes);objects_axes_container.call(objects_axes);colections_axes_container.call(colections_axes);area_axes_container.call(area_axes);
var foundation_axes_circles=foundation_axes_container.selectAll("circle").data([1860,2022]).join("circle").attr("data-value",function(a){return a}).attr("fill","deeppink").attr("fill-opacity",.6).attr("transform",function(a,b){return 0==b?null:"translate("+[max_radio,0]+")"}).attr("r",function(a){return foundation_radius_scale(a)}),objects_axes_circles=objects_axes_container.selectAll("circle").data([1,515E3]).join("circle").attr("data-value",function(a){return a}).attr("fill","deeppink").attr("fill-opacity",
.6).attr("transform",function(a,b){return 0==b?null:"translate("+[max_radio,0]+")"}).attr("r",function(a){return objects_radius_scale(a)}),colections_axes_circles=colections_axes_container.selectAll("circle").data([1,200]).join("circle").attr("data-value",function(a){return a}).attr("fill","deeppink").attr("fill-opacity",.6).attr("transform",function(a,b){return 0==b?null:"translate("+[max_radio,0]+")"}).attr("r",function(a){return colections_radius_scale(a)}),area_axex_circles=area_axes_container.selectAll("circle").data(d3.extent(dataset_museos,
function(a){return a.area})).data([1,8100]).join("circle").attr("data-value",function(a){return a}).attr("fill","deeppink").attr("fill-opacity",.6).attr("transform",function(a,b){return 0==b?null:"translate("+[max_radio,0]+")"}).attr("r",function(a){return area_radius_scale(a)}),prop_legend=["A\u00f1o de fundaci\u00f3n","Objetos","Colecciones","Superficie"],link_ref="Sitio web;Correo electr\u00f3nico;Facebook;Instagram;Twitter;Youtube".split(";"),link_class="web email fb ig tw yt".split(" "),museo_card_icon_size=
180,museos_info_divs=d3.select("#dataviz-museos-info-render").selectAll("div").data(dataset_museos).join("div").classed("dataviz-museo-card",!0);museos_info_divs.append("svg").attr("xml:space","preserve").attr("width",museo_card_icon_size).attr("height",museo_card_icon_size).attr("x",0).attr("y",0).append("use").attr("xlink:href",function(a,b){return dataset_museos[b].icon});museos_info_divs.append("h3").text(function(a,b){return dataset_museos[b].museum});
var table=museos_info_divs.append("table"),tr=table.selectAll("tr").data(function(a){return[a.foundation,a.objects,a.colections,a.area]}).join("tr");tr.append("td").text(function(a,b){return prop_legend[b]});tr.append("td").html(function(a,b){return 0==b?a||"\u00b7\u00b7\u00b7":3==b?a?a.toString().replace(/\d(?=(?:\d{3})+(?!\d))/g,"$&.")+"m<sup>2</sup>":"\u00b7\u00b7\u00b7":a?a.toString().replace(/\d(?=(?:\d{3})+(?!\d))/g,"$&."):"\u00b7\u00b7\u00b7"});
var links=table.append("tr").append("td").attr("colspan",2).selectAll("a").data(function(a){return[a.web,a.email,a.fb,a.ig,a.tw,a.yt]}).join("a").attr("class",function(a,b){return"museum-"+link_class[b]}).attr("href",function(a){return a?a.includes("@")?"mailto:"+a:a:null}).attr("target","_blank").text(function(a,b){return link_ref[b]});d3.selectAll("#dataviz-museos-info a:not([href])").remove();var end=performance.now();console.log("Dataviz render in "+(end-start)+"ms");
